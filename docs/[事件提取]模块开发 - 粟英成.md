### [事件提取]模块开发 - 粟英成

1. 事件数据结构标准化

- 设计统一的事件数据结构，包含 primaryType、subType、title、content 等字段

- 实现事件类型分类系统，包括情绪类、认知类、人际关系类等六大类事件

- 为不同类型事件配置对应的标签颜色，提升可视化效果

1. 事件提取服务实现

- 开发事件提取服务（EventService），集成 SambaNova LLM API

- 设计事件提取 Prompt，指导 LLM 从对话中提取关键事件

- 实现事件存储和管理功能，支持事件的增删改查

1. API 接口开发

- 实现事件提取接口 /api/events/extract，支持从对话中提取事件

- 实现事件列表接口 /api/events，支持分页查询和筛选

- 实现事件删除接口 /api/events/<event_id>，支持事件管理

1. 数据持久化

- ###### 基于文件系统实现轻量级数据存储

- 为每个会话创建独立的事件存储文件

- 支持事件数据的增删改查操作

这些改进使得系统能够：

- 自动从对话中提取关键事件，帮助用户记录重要时刻

- 对事件进行分类和标记，便于后续回顾和分析

- 提供完整的事件管理功能，支持用户对事件进行管理

后续计划：

- 优化事件提取的准确性，减少幻觉问题

- 完善事件分析功能，提供更深入的事件洞察

- 增强事件展示效果，提供更丰富的事件可视化



### 【事件提取】模块开发 - 粟英成

1. 事件数据结构标准化

- 设计统一的事件数据结构，包含 primaryType、subType、title、content、dialogContent 等字段

2. 事件提取服务实现

- 开发事件提取服务（EventService），支持多模型配置，独立使用 Qwen3-32B 模型避免 Rate Limit

- 设计专业的事件提取 Prompt，使用 response_format={"type": "json_object"} 确保稳定的 JSON 输出

- 集成异步事件提取机制，在用户对话时后台自动提取最近4条对话的事件

- 实现事件存储和管理功能，支持事件的增删改查

3. API 接口开发

- 实现事件提取接口 /api/events/extract，支持从对话中手动提取事件（主要用于测试）

- 实现事件列表接口 /api/events，支持按会话查询和分页

- 实现事件更新接口 /api/events/<event_id>，支持更新事件状态和内容

- 实现事件删除接口 /api/events/<event_id>，支持事件管理

4. 异步事件提取机制

- 在 /api/chat 接口中集成异步事件提取，用户对话时自动触发

- 使用 Python Threading 实现后台异步处理，不影响对话响应速度

- 自动获取最近4条对话内容进行事件提取，保证上下文完整性

5. 数据持久化

- 基于文件系统实现轻量级数据存储

- 为每个会话创建独立的事件存储文件（events/{session_id}.json）

- 支持事件数据的完整生命周期管理（创建、读取、更新、删除）

6. 前后端对接

- 开发前端 API 封装层，支持真实后端调用和 Mock 数据降级

- 实现前端事件服务的完整重构，支持会话级事件管理

- 保留 Mock 数据作为后备方案，提升开发和测试体验

以上的改进使得应用能够：

- 无感化事件提取：用户正常对话时，系统自动在后台提取和存储关键事件
- 精准事件分类：通过专业 Prompt 和强制 JSON 格式，确保事件提取的准确性和一致性


后续计划：

- 优化事件提取 Prompt，提升事件分类的准确性

- 增加事件去重机制，避免重复事件

- 完善事件分析功能，提供更深入的用户行为洞察

![image-20250617003828943](./assets/image-20250617003828943.png)
